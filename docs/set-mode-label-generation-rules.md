# 套盒模式箱标生成规律

## 核心概念
- **一套 = 一小箱**（套盒模式的基本单位）
- 用户输入：每套张数、每套盒数、每大箱套数
- 系统自动计算：每盒张数、总套数、总盒数、总大箱数

## 参数关系
- **每套张数**：用户输入（如：3780张）- 每个套包含的卡片总数
- **每套盒数**：用户输入（如：6盒）- 每个套分成几个盒子  
- **每大箱套数**：用户输入（如：2套）- 每个大箱包含几个套

## 小箱标
- **quantity**: 每套张数
  - 如：3780PCS（直接使用用户输入的每套张数）
- **serial**:
  - 格式: `{start_serial}-{end_serial}`
  - start_serial: `{serial_prefix}{set_num:05d}-01`
  - end_serial: `{serial_prefix}{set_num:05d}-{boxes_per_set:02d}`
  - 示例: `JAW01001-01-JAW01001-06` (套内完整范围)
  - 循环逻辑: 按套数递增，每套一页小箱标
- **carton_no**:
  - 格式: `{case_idx + 1:02d}`
  - 示例: `01`, `02`, `03`...
  - 表示当前套编号（补零格式）

## 大箱标
- **quantity**:
  - 计算方式: (该大箱包含的套数) × (每套张数)
  - 如：2套 × 3780张/套 = 7560PCS
- **serial**:
  - 格式: `{start_serial}-{end_serial}`
  - start_serial: `{serial_prefix}{start_set_num:05d}-01`
  - end_serial: `{serial_prefix}{end_set_num:05d}-{boxes_per_set:02d}`
  - 示例: `JAW01037-01-JAW01038-06` (跨套范围)
- **carton_no**:
  - 格式: `{start_set_num}-{end_set_num}`
  - 示例: `37-38`, `39-40`
  - 表示该大箱包含的套编号范围

## 自动计算逻辑
- **每盒张数** = 每套张数 ÷ 每套盒数（如：3780 ÷ 6 = 630张/盒）
- **总套数** = 总卡片数 ÷ 每套张数
- **总小箱数** = 总套数（一套=一小箱）
- **总大箱数** = 总套数 ÷ 每大箱套数（向上取整）
- **总盒数** = 总套数 × 每套盒数

## 关键规律
- **小箱标**: 套内完整范围
  - 每套生成一页小箱标
  - Serial表示该套从01到最大盒数的完整范围
  - Quantity直接使用每套张数

- **大箱标**: 跨套范围
  - 每个大箱包含多个套
  - Serial跨越多个套的完整范围
  - Quantity是包含套数的总和

- **页数计算**:
  - 小箱标页数: total_sets（总套数）
  - 大箱标页数: total_large_cases（总大箱数）
  - 总页数: 小箱标页数 + 大箱标页数

## 语义化描述

### 小箱标
- **quantity**
  - 每套张数（用户输入）
- **serial**
  - 父级编号
    - 套编号
      - 套数量-循环递增
  - 子级编号
    - 开始号
      - 01（固定）
    - 结束号
      - 每套盒数（自动计算）
- **carton_no**
  - 套编号
    - 套数量-循环递增（补零格式）

### 大箱标
- **quantity**
  - 每套张数 × 大箱中套数
- **serial**
  - 父级编号
    - 开始号和结束号不同（跨套）
      - 大箱数量-循环递增
  - 子级编号
    - 开始号
      - 01（固定）
    - 结束号
      - 每套盒数（套内最大盒数）
- **carton_no**
  - 套编号范围表示
    - 起始套编号-结束套编号

## 前端界面参数
### 基础参数
- **每套张数**：用户输入框，标签显示"每套张数"，提示"每个套包含的卡片数量"

### 高级参数  
- **每套盒数**：用户输入框，标签显示"每套盒数"，提示"每个套包含的盒子数量"
- **每大箱套数**：用户输入框，标签显示"每大箱套数"，提示"每个大箱包含的小箱数量"

### 参数预览显示
```
包装参数:
  每套张数: 3,780 张
  每套盒数: 6 盒
  每大箱套数: 2 套

计算结果:
  总盒数: 240 盒
  总套数: 40 套
  总大箱数: 20 大箱

序列号示例:
  套盒格式: JAW01001-01到JAW01001-06, JAW01002-01到JAW01002-06...

生成的PDF将包含:
  • 盒标: 240 页
  • 箱标: 60 页（套盒多级：40小箱+20大箱）
```

## 完整示例计算
假设参数：
- 总卡片数：151,200张
- 每套张数：3,780张
- 每套盒数：6盒
- 每大箱套数：2套

### 计算过程：
1. **每盒张数** = 3,780 ÷ 6 = 630张/盒
2. **总套数** = 151,200 ÷ 3,780 = 40套
3. **总小箱数** = 40套（一套=一小箱）
4. **总大箱数** = 40 ÷ 2 = 20大箱
5. **总盒数** = 40 × 6 = 240盒

### 生成结果：
- **小箱标**：40页（每套一页）
- **大箱标**：20页（每大箱一页）
- **盒标**：240页（每盒一页）

## 与其他模式的区别
- **常规模式**：一盒一标签
- **分盒模式**：多盒一小箱，多小箱一大箱  
- **套盒模式**：多盒一套（一套=一小箱），多套一大箱
